(function(T,m){typeof exports=="object"&&typeof module<"u"?module.exports=m():typeof define=="function"&&define.amd?define(m):(T=typeof globalThis<"u"?globalThis:T||self,T["ariane-router"]=m())})(this,function(){"use strict";const T=new Map,m=async e=>{try{const t=T.get(e);if(t)return await t;const n=ae(e);return T.set(e,n),await n}catch(t){throw t instanceof TypeError?new TypeError(`Network error fetching HTML from ${e}: ${t.message}`):t}},ae=async e=>{try{const t=await fetch(e);if(t.status!==200)throw new Error(`Error fetching HTML from ${e}: status code ${t.status}`);return await t.text()}catch(t){throw t}},X=new Map,ie=e=>{for(const t in e)X.set(t,e[t])},_=e=>{const t=X.get(e);if(t===void 0)throw new Error(`the action : ${e} does not exists`);return t()},se=e=>{if(ce(e))return e;try{return new Error(JSON.stringify(e))}catch{return new Error(String(e))}},ce=e=>typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string";var z=11;function fe(e,t){var n=t.attributes,r,a,u,l,y;if(!(t.nodeType===z||e.nodeType===z)){for(var N=n.length-1;N>=0;N--)r=n[N],a=r.name,u=r.namespaceURI,l=r.value,u?(a=r.localName||a,y=e.getAttributeNS(u,a),y!==l&&(r.prefix==="xmlns"&&(a=r.name),e.setAttributeNS(u,a,l))):(y=e.getAttribute(a),y!==l&&e.setAttribute(a,l));for(var L=e.attributes,O=L.length-1;O>=0;O--)r=L[O],a=r.name,u=r.namespaceURI,u?(a=r.localName||a,t.hasAttributeNS(u,a)||e.removeAttributeNS(u,a)):t.hasAttribute(a)||e.removeAttribute(a)}}var x,ue="http://www.w3.org/1999/xhtml",d=typeof document>"u"?void 0:document,le=!!d&&"content"in d.createElement("template"),oe=!!d&&d.createRange&&"createContextualFragment"in d.createRange();function de(e){var t=d.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function ve(e){x||(x=d.createRange(),x.selectNode(d.body));var t=x.createContextualFragment(e);return t.childNodes[0]}function he(e){var t=d.createElement("body");return t.innerHTML=e,t.childNodes[0]}function pe(e){return e=e.trim(),le?de(e):oe?ve(e):he(e)}function M(e,t){var n=e.nodeName,r=t.nodeName,a,u;return n===r?!0:(a=n.charCodeAt(0),u=r.charCodeAt(0),a<=90&&u>=97?n===r.toUpperCase():u<=90&&a>=97?r===n.toUpperCase():!1)}function ge(e,t){return!t||t===ue?d.createElement(e):d.createElementNS(t,e)}function me(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}function k(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var K={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();r==="OPTGROUP"&&(n=n.parentNode,r=n&&n.nodeName.toUpperCase()),r==="SELECT"&&!n.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}k(e,t,"selected")},INPUT:function(e,t){k(e,t,"checked"),k(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==n||!n&&a==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n=-1,r=0,a=e.firstChild,u,l;a;)if(l=a.nodeName&&a.nodeName.toUpperCase(),l==="OPTGROUP")u=a,a=u.firstChild;else{if(l==="OPTION"){if(a.hasAttribute("selected")){n=r;break}r++}a=a.nextSibling,!a&&u&&(a=u.nextSibling,u=null)}e.selectedIndex=n}}},S=1,Ae=11,W=3,j=8;function A(){}function Te(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function ye(e){return function(n,r,a){if(a||(a={}),typeof r=="string")if(n.nodeName==="#document"||n.nodeName==="HTML"||n.nodeName==="BODY"){var u=r;r=d.createElement("html"),r.innerHTML=u}else r=pe(r);var l=a.getNodeKey||Te,y=a.onBeforeNodeAdded||A,N=a.onNodeAdded||A,L=a.onBeforeElUpdated||A,O=a.onElUpdated||A,De=a.onBeforeNodeDiscarded||A,U=a.onNodeDiscarded||A,Ee=a.onBeforeElChildrenUpdated||A,B=a.childrenOnly===!0,w=Object.create(null),P=[];function D(c){P.push(c)}function ee(c,s){if(c.nodeType===S)for(var i=c.firstChild;i;){var f=void 0;s&&(f=l(i))?D(f):(U(i),i.firstChild&&ee(i,s)),i=i.nextSibling}}function E(c,s,i){De(c)!==!1&&(s&&s.removeChild(c),U(c),ee(c,i))}function te(c){if(c.nodeType===S||c.nodeType===Ae)for(var s=c.firstChild;s;){var i=l(s);i&&(w[i]=s),te(s),s=s.nextSibling}}te(n);function F(c){N(c);for(var s=c.firstChild;s;){var i=s.nextSibling,f=l(s);if(f){var v=w[f];v&&M(s,v)?(s.parentNode.replaceChild(v,s),C(v,s)):F(s)}else F(s);s=i}}function Ce(c,s,i){for(;s;){var f=s.nextSibling;(i=l(s))?D(i):E(s,c,!0),s=f}}function C(c,s,i){var f=l(s);f&&delete w[f],!(!i&&(L(c,s)===!1||(e(c,s),O(c),Ee(c,s)===!1)))&&(c.nodeName!=="TEXTAREA"?Re(c,s):K.TEXTAREA(c,s))}function Re(c,s){var i=s.firstChild,f=c.firstChild,v,h,b,H,p;e:for(;i;){for(H=i.nextSibling,v=l(i);f;){if(b=f.nextSibling,i.isSameNode&&i.isSameNode(f)){i=H,f=b;continue e}h=l(f);var V=f.nodeType,g=void 0;if(V===i.nodeType&&(V===S?(v?v!==h&&((p=w[v])?b===p?g=!1:(c.insertBefore(p,f),h?D(h):E(f,c,!0),f=p):g=!1):h&&(g=!1),g=g!==!1&&M(f,i),g&&C(f,i)):(V===W||V==j)&&(g=!0,f.nodeValue!==i.nodeValue&&(f.nodeValue=i.nodeValue))),g){i=H,f=b;continue e}h?D(h):E(f,c,!0),f=b}if(v&&(p=w[v])&&M(p,i))c.appendChild(p),C(p,i);else{var $=y(i);$!==!1&&($&&(i=$),i.actualize&&(i=i.actualize(c.ownerDocument||d)),c.appendChild(i),F(i))}i=H,f=b}Ce(c,f,h);var re=K[c.nodeName];re&&re(c,s)}var o=n,R=o.nodeType,ne=r.nodeType;if(!B){if(R===S)ne===S?M(n,r)||(U(n),o=me(n,ge(r.nodeName,r.namespaceURI))):o=r;else if(R===W||R===j){if(ne===R)return o.nodeValue!==r.nodeValue&&(o.nodeValue=r.nodeValue),o;o=r}}if(o===r)U(n);else{if(r.isSameNode&&r.isSameNode(o))return;if(C(o,r,B),P)for(var I=0,He=P.length;I<He;I++){var G=w[P[I]];G&&E(G,G.parentNode,!1)}}return!B&&o!==n&&n.parentNode&&(o.actualize&&(o=o.actualize(n.ownerDocument||d)),n.parentNode.replaceChild(o,n)),o}}var we=ye(fe);const be=async e=>{const n=new DOMParser().parseFromString(e,"text/html");document.title=n.title,we(document.body,n.body)},Se=async(e,t)=>{if(t){const[n]=await Promise.all([m(e),_(t)]);return n}return m(e)},Ne=async(e,t)=>{const{before:n,between:r,after:a}=t??{};try{const u=await Se(e,n);r&&_(r),be(u),history.pushState({},document.title,e),scrollTo(0,0),a&&_(a),J()}catch(u){const{message:l}=se(u);console.error(l),window.location.href=e}},Oe=["before","between","after"];let q={};const xe=e=>{q=e},Me=e=>({...q,...Le(e)}),Le=e=>Oe.reduce((t,n)=>{const r=e.getAttribute("ariane-"+n);return r==null?t:{...t,[n]:r}},{}),J=()=>{Ue().forEach(t=>{t.removeEventListener("mouseenter",Q),t.addEventListener("mouseenter",Q),t.removeEventListener("click",Y),t.addEventListener("click",Y)})},Y=async e=>{const t=Z(e);t&&(e.preventDefault(),Ne(t.href,Me(t)))},Q=e=>{const t=Z(e);t&&m(t.href)},Ue=()=>Array.from(document.querySelectorAll("a")).filter(e=>Array.from(e.attributes).some(({name:t})=>t.startsWith("ariane-"))),Z=e=>{const t=e.target;if(!t)return;const n=t.closest("a");if(n)return n},Pe=({selector:e,anim:t})=>{const n=document.querySelector(e);return new Promise((r,a)=>{if(!n){a(new Error("No Element for "+e));return}if(!(n!=null&&n.animate)){a("Element.animate is not supported in this environment");return}(n==null?void 0:n.animate(...t)).addEventListener("finish",l=>{r(l)})})};return{start:J,defineConfig:xe,addActions:ie,makeAnim:(e,...t)=>()=>Pe({selector:e,anim:t})}});
